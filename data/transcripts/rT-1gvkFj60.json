[{"text": "Let's just say you just created a homemade lithium-ion battery bank", "start": 0.86, "duration": 4.279}, {"text": "And if you have no idea how to do this then check out one of my previous videos", "start": 5.14, "duration": 5.19}, {"text": "Anyway, my pack got 4 cells in series with 2 cells in parallel each", "start": 11.56, "duration": 5.08}, {"text": "Which means it covers a voltage range of 16.8 to 12 volts", "start": 16.9, "duration": 4.02}, {"text": "outputs up to 40 amps continuously", "start": 21.5, "duration": 2.38}, {"text": "Features a capacity of 5 amp-hours and thus a nominal energy of 72 watt-hours", "start": 24.16, "duration": 5.94}, {"text": "That means that after adding wires to the pack", "start": 31.12, "duration": 3.44}, {"text": "and adjusting its output voltage to constant 12V with a suitable converter", "start": 34.56, "duration": 3.82}, {"text": "It is perfect for powering 12 volt devices", "start": 38.78, "duration": 3.26}, {"text": "But such a naked battery pack is not 100% safe to work with", "start": 42.34, "duration": 4.72}, {"text": "For example, if the battery pack got discharged", "start": 47.66, "duration": 3.4}, {"text": "I can charge it up with an appropriate constant-current constant-voltage method", "start": 51.22, "duration": 4.94}, {"text": "But during that process I noticed that not all cells feature the exact same voltage", "start": 56.3, "duration": 5.18}, {"text": "The reason is that not every cell is chemically identical and thus they all feature", "start": 62.69, "duration": 5.299}, {"text": "slightly different capacities and thus charge up faster which can lead to misalignments in the voltage of the cells and", "start": 68.18, "duration": 7.66}, {"text": "ultimately in the destruction due to over voltage", "start": 76.06, "duration": 3.82}, {"text": "Or let's say the load failed and the battery got shorted, which I will certainly not try out", "start": 80.32, "duration": 6.02}, {"text": "because battery shorts can do a lot of damage", "start": 86.689, "duration": 3.05}, {"text": "To avert such safety problems, you can get yourself a BMS", "start": 90.74, "duration": 4.32}, {"text": "or battery management system from ebay for cheap", "start": 95.2, "duration": 4.42}, {"text": "Those not only offer a balanced charging and short-circuit protection,", "start": 99.62, "duration": 5.02}, {"text": "but also overcharge and discharge protection", "start": 104.64, "duration": 2.9}, {"text": "but since some viewers do not really trust such BMS circuits from eBay and", "start": 107.62, "duration": 5.0}, {"text": "tons of you asked asked for DIY BMS", "start": 112.82, "duration": 3.18}, {"text": "we will have a closer look at a commercial BMS and explain all of its functions and", "start": 116.34, "duration": 5.34}, {"text": "then create a DIY PMS based on Stewart Pittaway's design", "start": 121.9, "duration": 5.1}, {"text": "in order to find out whether you should go with the commercial version or go the DIY route instead", "start": 127.16, "duration": 6.56}, {"text": "Let's get started...", "start": 134.06, "duration": 2.56}, {"text": "[2011 Lookalike by Bartlebeats playing]", "start": 136.62, "duration": 10.34}, {"text": "This video is sponsored by JLCPCB", "start": 147.64, "duration": 3.48}, {"text": "where you can now get ten PCB's in all available colors for the price of only two dollars and", "start": 151.36, "duration": 5.9}, {"text": "new customers also get a shipping discount on their first order", "start": 157.64, "duration": 4.28}, {"text": "To properly understand commercial BMS I got myself a few different ones", "start": 162.22, "duration": 6.2}, {"text": "The one I will have a closer look at will be the biggest one", "start": 168.66, "duration": 4.0}, {"text": "which basically comes with all the protection features you need", "start": 172.66, "duration": 3.72}, {"text": "After removing its top heatsink as well as its bottom paper insulation,", "start": 176.72, "duration": 5.18}, {"text": "I examined these circuit and found out that the PCB is divided in three functional groups", "start": 182.45, "duration": 5.72}, {"text": "So let's start off with the top side and the components closest to the", "start": 189.04, "duration": 4.66}, {"text": "balanced connector which like the name implies", "start": 193.78, "duration": 2.96}, {"text": "Connects to each cell of the battery pack", "start": 196.94, "duration": 2.18}, {"text": "By having a look at the components under the microscope", "start": 200.06, "duration": 3.44}, {"text": "We can for one see a bunch of passive components like capacitors and resistors", "start": 203.8, "duration": 5.18}, {"text": "But also two transistors for each cell and one DW01A IC", "start": 209.56, "duration": 6.38}, {"text": "This IC protects each cell from overcharge, overdischarge, and overcurrent", "start": 216.8, "duration": 5.18}, {"text": "by simply utilizing 2 transistors", "start": 221.98, "duration": 2.82}, {"text": "Which we had a look at before in order to cut the cells connection to the load", "start": 224.98, "duration": 5.26}, {"text": "By flipping the PCB around, we got more components near the balanced connector", "start": 230.92, "duration": 4.94}, {"text": "Which once again where a couple of complementary passive components and also once again a transistor,", "start": 236.02, "duration": 6.8}, {"text": "but this time in combination with some bigger 200 ohm resistors and a BB3A IC", "start": 243.049, "duration": 6.71}, {"text": "Those markings on the IC are those of an HY2213 IC", "start": 250.7, "duration": 5.34}, {"text": "which is one cell lithium ion lipo balance charge IC", "start": 256.36, "duration": 4.52}, {"text": "as you can see in the example circuit of the data sheets.", "start": 261.12, "duration": 3.1}, {"text": "it's job is to activate the transistor", "start": 264.38, "duration": 2.64}, {"text": "Which then discharges one battery cell through a resistor", "start": 267.3, "duration": 3.6}, {"text": "as soon as the cell voltage goes above a certain voltage value", "start": 271.1, "duration": 4.42}, {"text": "this way, after the charging process, all cells of the battery pack get charged up to 4.2 volts", "start": 275.72, "duration": 6.92}, {"text": "and we got a balanced pack", "start": 282.8, "duration": 2.24}, {"text": "Last, but not least, on the top side of the PCB right next to the B-, P-, and C- terminal", "start": 285.71, "duration": 6.649}, {"text": "Where you would hook up the main wires of the battery pack,", "start": 292.669, "duration": 2.78}, {"text": "we got 6P75NF75 N-channel power MOSFETs a", "start": 296.06, "duration": 5.63}, {"text": "A couple of passive components with transistors", "start": 302.3, "duration": 2.66}, {"text": "and three bigger resistors which act as a current shunt", "start": 304.96, "duration": 4.72}, {"text": "The way this works is that as soon as the battery draws more than the beam s max current of 35 amps,", "start": 309.92, "duration": 6.3}, {"text": "we got a voltage drop high enough across the current shunt to activate the passive component network and", "start": 316.64, "duration": 6.34}, {"text": "Thus turn of the MOSFETs and therefore the current flow", "start": 323.39, "duration": 3.799}, {"text": "This way the three functional groups of this BMS fulfill all the required battery pack protection features", "start": 328.18, "duration": 7.66}, {"text": "Pretty much all the other BMS followed the same PCB principle", "start": 336.22, "duration": 4.38}, {"text": "The only thing that is different sometimes is that balanced charging is not included", "start": 341.26, "duration": 5.06}, {"text": "And now that we know how a commercial BMS works and how much they cost on average", "start": 346.7, "duration": 5.42}, {"text": "I thought about how to create an improved version", "start": 352.16, "duration": 3.58}, {"text": "but while coming up with my own plan", "start": 356.24, "duration": 2.42}, {"text": "I realized that a viewer recommended me to have a look at Colin Hickey's or Adam Welsh's work for reference", "start": 358.88, "duration": 7.38}, {"text": "They have built and created a couple of videos about the DIY BMS (process)", "start": 366.7, "duration": 5.18}, {"text": "Which is a project from Stuart Pittaway that you can find on github", "start": 372.16, "duration": 4.96}, {"text": "After downloading its smaller PCB branch which like the name implies comes with a smaller PCB than its regular version", "start": 377.86, "duration": 7.3}, {"text": "I had a closer look at the schematic of the PCB to find out how it works", "start": 385.18, "duration": 6.04}, {"text": "First off after hooking up a battery cell this REG710NA regulator", "start": 391.44, "duration": 6.7}, {"text": "Creates a stable 3.3 volts for the ADUM1250", "start": 398.3, "duration": 4.66}, {"text": "I2C isolator and the AT Tiny 85 microcontroller", "start": 403.22, "duration": 5.3}, {"text": "Through a voltage divider, the battery cells raw voltage get sampled and monitored by the AT Tiny 85", "start": 408.94, "duration": 7.34}, {"text": "Which every few seconds sends over this voltage value through its I2C bus to the I2C isolator", "start": 416.75, "duration": 7.129}, {"text": "Which is on the other side hooked up to an ESP8266", "start": 424.18, "duration": 4.74}, {"text": "development board which then provides this data for viewing through web browser", "start": 429.22, "duration": 5.98}, {"text": "But not only does the circuits monitor the voltage as well as the", "start": 435.4, "duration": 4.88}, {"text": "temperature of the battery cells through a thermistor", "start": 440.28, "duration": 2.6}, {"text": "But it also got a MOSFET, which if the battery voltage needs to get lowered, connects it to power resistor", "start": 443.06, "duration": 7.1}, {"text": "So online monitoring and balancing is easily possible", "start": 450.88, "duration": 4.08}, {"text": "which were improvements I was looking for", "start": 454.96, "duration": 2.76}, {"text": "That is why I uploaded the Gerber files of the PCB to JLCPCB", "start": 458.14, "duration": 5.6}, {"text": "in order to get ten of them for two dollars plus shipping", "start": 464.08, "duration": 4.18}, {"text": "and afterwards started sourcing the required components.", "start": 468.44, "duration": 3.76}, {"text": "I got the majority of them from Mouser and only a few either too expensive or special ones from eBay", "start": 472.72, "duration": 7.08}, {"text": "So as soon as the components arrived,", "start": 480.68, "duration": 2.48}, {"text": "as well as the PCBs, which looked very nice", "start": 483.16, "duration": 3.24}, {"text": "it was time a for soldering", "start": 486.58, "duration": 2.1}, {"text": "I basically used tons of flux, a microscope", "start": 489.68, "duration": 3.42}, {"text": "and a fine soldering tip to solder all SMD components to the boards", "start": 493.1, "duration": 4.48}, {"text": "According to the schematic which was pretty easy to do", "start": 497.78, "duration": 4.26}, {"text": "The only thing I messed up was that I ordered one component package size too big", "start": 502.16, "duration": 5.12}, {"text": "Which still worked for the resistors but was not the best option for the capacitors", "start": 507.52, "duration": 5.66}, {"text": "but nevertheless after three hours of soldering the SMD components of poor PCBs were soldered on", "start": 513.7, "duration": 7.38}, {"text": "Next I added the big power resistors, as well as the female header", "start": 521.62, "duration": 5.1}, {"text": "for programming and the JST terminals fully battery and the I2C lines to each board", "start": 526.72, "duration": 6.4}, {"text": "For the ESP8266 port, I went with this note MCU", "start": 533.76, "duration": 5.74}, {"text": "Which I soldered onto a small piece of perf. board to which I also edit a 4-pin JST terminal", "start": 539.68, "duration": 7.46}, {"text": "Its pins connect to 3.3 volts, D1, D2, and ground of the ESP8266", "start": 547.4, "duration": 7.4}, {"text": "Which are mandatory for the I2C communication", "start": 555.02, "duration": 4.08}, {"text": "To program the ESP. I simply hooked it up to my computer", "start": 559.52, "duration": 4.14}, {"text": "Opened the given code for it, selected baud settings like they were described in the code and click upload", "start": 563.74, "duration": 7.34}, {"text": "After successfully uploading the code, it was time for the AT Tiny boards", "start": 572.38, "duration": 4.84}, {"text": "For which we only have an ICSP connector for programming", "start": 577.26, "duration": 5.02}, {"text": "So I connected an Arduino UNO to my computer in order to upload the arduino ISP Sketch to it", "start": 582.76, "duration": 8.24}, {"text": "Afterwards, I connected the Arduino UNO to the ICSP pins like it is shown here and", "start": 591.32, "duration": 6.4}, {"text": "Continued by downloading the proper board library mentioned in the code", "start": 598.28, "duration": 4.5}, {"text": "setting the correct board properties", "start": 602.94, "duration": 3.0}, {"text": "burning the bootloader which only sets the correct fuses of the AT Tiny and", "start": 606.04, "duration": 5.48}, {"text": "finally uploaded the code through the programmer which worked like a charm and", "start": 612.11, "duration": 5.089}, {"text": "As soon as all four boards were programmmed, it was time for the assembly.", "start": 617.9, "duration": 5.24}, {"text": "I Hooked up each battery cell pair to one PCB you through a JST wire that I prepared beforehand", "start": 623.34, "duration": 7.46}, {"text": "Once that was done, I connected the ESP8266 to power and", "start": 631.28, "duration": 5.14}, {"text": "firstly had to connect to it with my computer in order to enter its IP address in a browser to", "start": 636.62, "duration": 6.7}, {"text": "properly connect the ESP to my router", "start": 643.61, "duration": 2.75}, {"text": "I then checked my router to determine the new IP address of the ESP and typed it in to properly connect to it", "start": 647.06, "duration": 8.28}, {"text": "On the page. We cannot see much yet, but by clicking modules", "start": 655.58, "duration": 4.9}, {"text": "we can hit the provision button after connecting the first PCB to the ESP through a four pin JST wire (connector)", "start": 660.7, "duration": 8.06}, {"text": "After a few seconds, we should see the first module with the measured voltage and temperature of the battery cell", "start": 669.6, "duration": 7.04}, {"text": "After then repeating this connection and provision button hitting process three more times,", "start": 677.46, "duration": 5.42}, {"text": "We finally got all the modules recognized by the software which looked pretty awesome so far", "start": 683.06, "duration": 7.12}, {"text": "What I was missing though was a setting to set a maximum allowed voltage", "start": 690.42, "duration": 5.52}, {"text": "Thankfully though Colin Hickey improved the software which on the bad side means I had to reprogram all the boards", "start": 696.16, "duration": 7.48}, {"text": "But on the bright side means we got a maximum voltage setting plus a few more helpful settings", "start": 703.96, "duration": 6.54}, {"text": "Now after properly calibrating the battery cell voltages", "start": 711.02, "duration": 3.5}, {"text": "I set the maximum voltage to 4.1 volts", "start": 714.53, "duration": 3.99}, {"text": "and started charging the battery pack with my lab bench power supply", "start": 718.74, "duration": 4.54}, {"text": "as you can see, near the end of the charging process,", "start": 723.36, "duration": 3.42}, {"text": "the batteries exceeded this 4.1 volt value and", "start": 727.08, "duration": 3.6}, {"text": "Thus the boards balance them out by drawing around one amp of current through the power resistor", "start": 730.84, "duration": 7.3}, {"text": "so all and all the DIY BMS seems to work fine and", "start": 738.36, "duration": 4.54}, {"text": "offers with its online monitoring and balance charge function", "start": 743.12, "duration": 4.2}, {"text": "features that commercial BMS do not offer", "start": 747.54, "duration": 3.48}, {"text": "Only problem is that it is more expensive", "start": 751.18, "duration": 3.02}, {"text": "takes up a bit of time to solder and worst of all draws in", "start": 754.46, "duration": 3.3}, {"text": "quite a lot of current from each battery cell", "start": 757.76, "duration": 3.86}, {"text": "in comparison to commercial BMS", "start": 761.84, "duration": 2.6}, {"text": "So the DIY BMS makes sense to use in combination with, for example, a DIY power wall", "start": 764.66, "duration": 6.4}, {"text": "Which gets charged up through solar power,", "start": 771.44, "duration": 3.3}, {"text": "but not for your regular battery pack which sits around most of the time", "start": 774.82, "duration": 4.32}, {"text": "Because of that I declare that both DIY and BUY are this time the winner", "start": 779.52, "duration": 5.56}, {"text": "Because when used for the right application,", "start": 785.3, "duration": 2.84}, {"text": "they offer their own advantages that the other version does not have", "start": 788.14, "duration": 4.86}, {"text": "But what do you think? Let me know in the comment section below as", "start": 793.26, "duration": 4.36}, {"text": "Always thanks for watching. Don't forget to Like, share, Subscribe", "start": 797.82, "duration": 4.92}, {"text": "Stay creative and I will see you next time!", "start": 802.74, "duration": 4.66}]